2022-12-31 01:32
Tags: #MongoDB

---
Таблицы - это колесции
Строки - это документы (объекты)

---

`show databases` - список имеющихся баз данных (`show dbs`)
`use nameBD` - использоать БД или изменять колекции, если БД нет то она будет создана
`db.dropDatabase` - удалить БД

---

`db.createCollection("users")` - создать колекцию в БД
`show collections` - посмотреть колекции в БД

---
### Добавление данных

`db.users.create({name: "Vladimir", age: 29})` - добавить документ в колекцию
`db.users.insertMany([
{name: "Vladimir", age: 29},
{name: "Alex", age: 24}
])` - добавить несколько документов

---
### Получение данных

`db.users.find()` - запрос на получение документа

`db.users.find({ _id: ObjectId("63af708193a78cedab23ba46")})` - получение по id

`db.users.find({age: 29, name: "Vova"})` - получение данные по критериям "и"
`db.users.find({ $or: [{age: 29}, {name: "Vova"}]})` - пол. данные с условием "или"

`db.users.find({age: {$lt: 29}})` - меньше чем указанное число
`db.users.find({age: {$lte: 29}})` - меньше чем или равно указанного числа
`db.users.find({age: {$gt: 29}})` - больше чем указанное число
`db.users.find({age: {$ne: 29}})` - неравен задонному значению

`db.users.find().sort({age: 1})` - сортировать в прямом порядке
`db.users.find().sort({age: -1})` - сортировать в обратном порядке

`db.users.find().limit(3)` - ограничиваем количество возвращаемых документов

```JSON
// поиск пользователя который обладает заданным ключём
db.users.find({posts: {$sxists: true}})
```

```JSON
// показать данные все посты пользователя
db.users.findOne(
	{name: "Vova"}, // первый параметр это поиск по заддноному критерию
	{posts: 1} // показать данные из массива
)
```

```JSON
// поиск пользователя у которого есть пост с названием "JavaScript"
db.users.find({
	posts: { // поиск в массиве данных
		$elemMatch: { // ищем пользователя у которого есть конкретный пост
			title: "JavaScript" // критерий по которому 
		}
	}
})
```

---

### Изменение данных

```JSON
db.users.update(
	{name: "Vova"}, // первый параметр это поиск по заддноному критерию
	{$set: {name: "Vladimir", age: 29 }} // то на что заменить
)
```

```JSON
db.users.update(
	{}, // пустой чтобы обновить все записи
	{$rename: {name: "fullName" }} //имя на которое переименовать ключ объекта
)
```

---

### Удаление данных
`db.users.deleteOne({age: 29})` - удалить данные с заданым параметром

---

### Множественные запросы

```json
db.users.bulkWrite([
	{
		insertOne: { // название операции которую хотим сделать
			document: {name: "Vova", age: 29}
		}
	},
	{
		deleteOne: { // следующая операция
			filter: {name: "Vova"}
		}
	}
])
```

---

## Один ко многим
Один пользователь может иметь много постов но пост принадлежит только одному пользователю.

```JSON
db.users.update(
	{name: "Vova"},
	{$set: {
		posts: [
			{title: "JavaScript", text: "js top"},
			{title: "MongoDB", text: "MongoDB top"}
		]
	}}
)
```

---

## Многие ко многим
Есть общая таблица в которой сопаствляются id из двух других таблиц
![[mongodb-table-links.png]]
---
__
### Links
[[Базы данных]]
